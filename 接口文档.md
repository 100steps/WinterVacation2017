# 论坛接口文档  
## __目录__  
### [用户](#用户)  
* [用户注册](#用户注册)  
* [用户注销](#用户注销)  
* [获取用户信息](#获取用户信息)  
* [修改用户信息](#修改用户信息)  
* [用户登陆](#用户登陆)  
* [用户退出](#用户退出)  
* [获取用户头像](#获取用户头像)  
* [修改用户头像](#修改用户头像)  
* [获取验证码](#获取验证码)  
### [论坛](#论坛)  
* [获取版块](#获取版块)  
* [新建版块](#新建版块)  
* [修改版块](#修改版块)  
* [删除版块](#删除版块)  
* [发布帖子](#发布帖子)  
* [获取帖子](#获取帖子)  
* [修改帖子](#修改帖子)  
* [删除帖子](#删除帖子)  
* [获取帖子列表](#获取帖子列表)  
* [新建回复](#新建回复)  
* [删除回复](#删除回复)  
* [获取回复](#获取回复)  
  
### [code说明](#code说明)  
  
## __用户__   
  
***  
### __用户注册__
* 接口说明  
    
* URL  
  `./api/user/user.php`  
* HTTP请求方式  
  POST  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|name|string||  
|email|string||  
|password|string||  
|captcha|string|验证码，获取验证码图片后，服务器会用session储存验证码，与之对比|  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------| 
|code|int||  
|error|string||  
  
***  
### __用户注销__  
* 接口说明  
    
* URL  
  `./api/user/user.php`  
* HTTP请求方式  
  DELETE  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|name|string||  
|email|string||  
|password|string||  
|captcha|string||  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
***  
### __获取用户信息__  
* 接口说明  
    
* URL  
  `./api/user/user.php`  
* HTTP请求方式  
  GET  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|name|string||  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
|name|string||  
|email|string||  
|sex|string|male/famale|  
|birthday|string|使用"-"分割|  
|province|string||  
|city|string||  
|phoneNumber|string||  
|qq|long int||  
|signature|string|个性签名|  
|imageUrl|string|用户头像url|  
  
### __修改用户信息__  
* 接口说明  
    
* URL  
  `./api/user/user.php`  
* HTTP请求方式  
  DELETE  
* 参数  
   
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
|name|string|不可修改|  
|email|string||  
|sex|string|male/famale|  
|birthday|string|以"-"分隔|  
|province|string|省|  
|city|string|市|  
|phoneNumber|string||  
|qq|long int||  
|signature|string||  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
***  
### __用户登陆__  
* 接口说明  
  用户登陆后服务器使用session保留name  
* URL  
  `./api/user/session.php`  
* HTTP请求方式  
  POST  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|nameOrEmail|string||  
|password|string||  
|captcha|string||  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
|name|string|返回用户名|  
***  
### __用户退出__  
* 接口说明  
    
* URL  
  `./api/user/session.php`  
* HTTP请求方式  
  DELETE  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|name|string||  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
***  
### __获取用户头像__  
* 接口说明  
    
* URL  
  `./api/user/userImage.php`  
* HTTP请求方式  
  GET  
* 参数  
  
请求参数
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|name|string||  
|type|int|1:原图,2:缩略图|  
  
返回参数
  
|参数名称|类型|参数描述| 
|--------|----|--------|  
|image|image||  
***  
### __修改用户头像__  
* 接口说明  
    
* URL  
  `./api/user/userImage.php`  
* HTTP请求方式  
  PUT  
* 参数  

请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|image|image||  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
***  
### __获取验证码__  
* 接口说明  
  获取验证图片，服务器返回图片后使用session储存验证码  
* URL  
  `./api/user/captchaImage.php`  
* HTTP请求方式  
  GET  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|image|image||  
***  
  
## __论坛__  
### __获取版块__  
* 接口说明  
  
* URL  
  `./api/forum/sections.php`  
* HTTP请求方式  
  GET  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
|amount|int|版块数量|  
|1|json对象|{"name":"","moderator":"","introduce":""},返回版块名称、版主、版块介绍|  
|2|json对象|共amount个json对象|  
***  
### __新建版块__  
* 接口说明  
    
* URL  
  `./api/forum/sections.php`  
* HTTP请求方式  
  POST  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|name|string||  
|moderator|string|版主，可为null|  
|introduce|string|可不填，默认为"此版块暂无介绍"|  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
***  
### __修改版块__  
* 接口说明  
    
* URL  
  `./api/forum/sections.php`  
* HTTP请求方式  
  PUT  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|
|--------|----|--------|  
|name|string|不可修改|  
|moderators|json数组||  
|introduce|string||  
|blacklist|json数组|元素为用户名，只有管理员和版主有权限修改|  
|closed|bool|版块是否被关闭，只有管理员有权限修改|  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
***  
### __删除版块__  
* 接口说明  
    
* URL  
  `./api/forum/sections.php`  
* HTTP请求方式  
  DELETE  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|name|string||  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
***  
### __发布帖子__  
* 接口说明  
  发布时间和作者由服务器补充  
* URL  
  `./api/post.php`  
* HTTP请求方式  
  POST  
* 参数  
  
请求参数    
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|title|string||  
|section|string|版块|  
|text|text|正文|  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
|id|int||  
***  
  
### __获取帖子__  
* 接口说明  
    
* URL  
  `./api/post.php`  
* HTTP请求方式  
  GET  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|id|long int||  
|replyNumber|int|获取回复数量,可空，默认10个|  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
|title|string|不大于255字节|  
|date|string||
|text|text|不大于65,532字节|  
|essential|bool|精华帖|  
|top|bool|置顶|   
|replyAmount|int|帖子回复数量|  
|replyNumber|int|获取的回复数量|  
|reply|json数组|数组元素为json对象{"number":,"user":"","date":"","text":""},分别为：第几个回复、回复者、回复时间、回复内容，共replyMumber个，最多replyAmount个|  
  
***  
### __修改帖子__  
* 接口说明  
  实现修改正文，加精，置顶的操作  
* URL  
  `./api/post.php`  
* HTTP请求方式  
  PUT  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|title|string|不大于255字节|  
|text|text|不大于65,532字节|  
|essential|bool|精品帖,只有管理员和版主有权限|  
|kind|string|精品帖的分类，精品帖必填|  
|top|bool|置顶，只有管理员和版主有权限|  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
***  
### __删除帖子__  
* 接口说明  
    
* URL  
  `./api/post.php`  
* HTTP请求方式  
  DELETE  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|id|long int||  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
***  
### __获取帖子列表__  
  
* 接口说明  
* URL  
  `./api/forum/postList.php`  
* HTTP请求方式  
  GET  
* 参数  
  
请求参数   
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|section|string||  
|type|string|essential/active/top|  
|start|int|从第几个帖子开始获取，用于分页|  
|amount|int|获取帖子的数量|  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
|number|int|返回数量，出现帖子数量不足时返回全部，数量以这个参数为准|  
|postList|json数组|元素为json对象，{"id":"","title":"","author":"","date":"","reply":"","url":""},分别为：id、标题、作者、发帖日期、回复数量，获取该帖子的url,共number个|  
  
***  
### __新建回复__  
* 接口说明  
  服务器补充用户名和发表时间  
* URL  
  `./api/forum/repty.php`  
* HTTP请求方式  
  POST  
* 参数  
  
请求参数   
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|id|long int|帖子的ID|  
|text|text||  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
  
***  
### __删除回复__  
* 接口说明  
  只有回复者和版主有权限，删除后text为null  
* URL  
  `./api/forum/repty.php`  
* HTTP请求方式  
  DELETE  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|id|long int|帖子ID|  
|number|int|第几个回复|  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
  
***    
  
### __获取回复__  
* 接口说明  
    
* URL  
  .api/  
* HTTP请求方式  
  GET  
* 参数  
  
请求参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|id|long int|帖子ID|  
|number|int|从第几个回复开始获取|  
|amount|int|获取的数量|  
  
返回参数  
  
|参数名称|类型|参数描述|  
|--------|----|--------|  
|code|int||  
|error|string||  
|reply|json数组|数组元素为json对象{"number":,"user":"","date":"","text":""}|  
***  
  
## __code说明__   
* 200 OK - [GET]：服务器成功返回用户请求的数据，该操作是幂等的（Idempotent）。  
* 201 CREATED - [POST/PUT/PATCH]：用户新建或修改数据成功。  
* 202 Accepted - [*]：表示一个请求已经进入后台排队（异步任务）  
* 204 NO CONTENT - [DELETE]：用户删除数据成功。
* 400 INVALID REQUEST - [POST/PUT/PATCH]：用户发出的请求有错误，服务器没有进行新建或修改数据的操作，该操作是幂等的。
* 401 Unauthorized - [*]：表示用户没有权限（令牌、用户名、密码错误）。  
* 403 Forbidden - [*] 表示用户得到授权（与401错误相对），但是访问是被禁止的。  
* 404 NOT FOUND - [*]：用户发出的请求针对的是不存在的记录，服务器没有进行操作，该操作是幂等的。  
* 406 Not Acceptable - [GET]：用户请求的格式不可得（比如用户请求JSON格式，但是只有XML格式）。  
* 410 Gone -[GET]：用户请求的资源被永久删除，且不会再得到的。  
* 422 Unprocesable entity - [POST/PUT/PATCH] 当创建一个对象时，发生一个验证错误。  
* 500 INTERNAL SERVER ERROR - [*]：服务器发生错误，用户将无法判断发出的请求是否成功。  
* 401 Unauthorized - [*]：表示用户没有权限（令牌、用户名、密码错误）。
* 403 Forbidden - [*] 表示用户得到授权（与401错误相对），但是访问是被禁止的。
* 404 NOT FOUND - [*]：用户发出的请求针对的是不存在的记录，服务器没有进行操作，该操作是幂等的。
* 406 Not Acceptable - [GET]：用户请求的格式不可得（比如用户请求JSON格式，但是只有XML格式）。
* 410 Gone -[GET]：用户请求的资源被永久删除，且不会再得到的。
* 422 Unprocesable entity - [POST/PUT/PATCH] 当创建一个对象时，发生一个验证错误。
* 500 INTERNAL SERVER ERROR - [*]：服务器发生错误，用户将无法判断发出的请求是否成功。
